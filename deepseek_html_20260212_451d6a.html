<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
  <title>å…¨å›½ä»»æ„åŸå¸‚ Â· çœçº§åœ°çº§æ ‘ç»“æ„ Â· åŸç”Ÿå¤©æ°”å¡ç‰‡</title>
  <style>
    /* ========== çº¯åŸç”Ÿ Â· é›¶ç»„ä»¶ Â· é›¶æ¡†æ¶ ========== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(145deg, #c8dbe9 0%, #b0cade 100%);
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
      display: flex; align-items: center; justify-content: center;
      min-height: 100vh; padding: 1.5rem; margin: 0;
    }
    .weather-card {
      max-width: 860px; width: 100%;
      background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px);
      background: linear-gradient(155deg, #fbfefe 0%, #ebf5fb 100%);
      border-radius: 52px; box-shadow: 0 26px 48px -18px rgba(0,40,70,0.24), 0 8px 12px -8px rgba(0,0,0,0.04), inset 0 0 0 1px rgba(255,255,255,0.7);
      padding: 2rem 2.2rem 2.2rem; border: 1px solid rgba(255,255,255,0.6);
      transition: box-shadow 0.25s;
    }
    .weather-card:hover { box-shadow: 0 32px 56px -20px rgba(0,60,98,0.32); }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
    .city { display: flex; align-items: center; gap: 4px; font-size: 1.7rem; font-weight: 660; color: #0a2c3d; }
    .city::before { content: "ğŸ“"; font-size: 1.6rem; margin-right: 4px; }
    .time { display: flex; align-items: center; gap: 5px; font-size: 1rem; font-weight: 520; color: #256077; background: rgba(156,208,230,0.14); padding: 0.4rem 1rem; border-radius: 50px; border: 0.5px solid rgba(60,160,210,0.2); backdrop-filter: blur(2px); }
    .time::before { content: "ğŸ•’"; font-size: 1.05rem; }
    #time-text { font-weight: 550; color: #105e78; }

    /* ---------- â˜… æ ‘å½¢é€‰æ‹© Â· çœå¸‚è”åŠ¨ (çº¯åŸç”Ÿ) ---------- */
    .tree-selector {
      background: rgba(220, 240, 250, 0.4); backdrop-filter: blur(4px);
      border-radius: 48px; padding: 1.1rem 1.4rem; margin: 0.5rem 0 1.2rem;
      border: 0.5px solid rgba(50, 150, 210, 0.25);
      display: flex; flex-wrap: wrap; align-items: center; gap: 0.8rem;
    }
    .selector-label {
      font-size: 0.9rem; font-weight: 600; color: #1d6279; letter-spacing: 0.5px;
      display: flex; align-items: center; gap: 4px;
    }
    .selector-label::before { content: "ğŸ—‚ï¸"; font-size: 1.1rem; }
    .custom-select {
      background: white; border: 0.5px solid rgba(40,130,180,0.3);
      border-radius: 40px; padding: 0.4rem 1.2rem; font-size: 0.9rem;
      color: #043f54; font-weight: 500; outline: none; cursor: pointer;
      backdrop-filter: blur(2px); transition: all 0.15s;
      max-width: 160px; min-width: 120px;
    }
    .custom-select:hover { border-color: rgba(30,150,210,0.8); background: rgba(255,255,255,0.9); }
    .view-btn {
      background: rgba(40, 150, 210, 0.2); border: 0.5px solid rgba(30,130,190,0.5);
      border-radius: 40px; padding: 0.4rem 1.4rem; font-size: 0.9rem;
      font-weight: 600; color: #046880; cursor: pointer; transition: 0.1s;
      display: flex; align-items: center; gap: 4px;
    }
    .view-btn:hover { background: rgba(60, 170, 230, 0.3); border-color: #1a8ab0; }
    .view-btn::before { content: "ğŸ”"; font-size: 0.95rem; }

    /* ----- ä»Šæ—¥ä¸»å¤©æ°” ----- */
    .weather-main { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem; }
    .temp-section { display: flex; flex-direction: column; }
    .current-temp { display: flex; align-items: flex-start; line-height: 1; }
    .temp-number { font-size: 5.6rem; font-weight: 280; color: #023344; letter-spacing: -7px; }
    .temp-unit { font-size: 2.2rem; font-weight: 350; color: #32788b; margin-left: 6px; margin-top: 14px; }
    .hi-lo { display: flex; gap: 1.2rem; margin-top: 0.1rem; font-size: 1.1rem; font-weight: 540; }
    .high { color: #cf5e4a; display: flex; align-items: center; gap: 4px; }
    .high::before { content: "â–²"; font-size: 0.9rem; color: #ea7b6b; }
    .low { color: #3b80a3; display: flex; align-items: center; gap: 4px; }
    .low::before { content: "â–¼"; font-size: 0.9rem; color: #57a6c7; }
    .condition-section { display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle at 30% 30%, rgba(255,210,70,0.18) 0%, transparent 70%); padding: 0.3rem 0.8rem 0.1rem; border-radius: 80px; }
    .weather-icon { font-size: 4.6rem; line-height: 1; filter: drop-shadow(0 10px 18px rgba(255,150,0,0.18)); margin-bottom: 0.1rem; }
    .weather-desc { font-size: 1.1rem; font-weight: 620; color: #19586d; background: rgba(255,248,190,0.7); padding: 0.2rem 1.2rem; border-radius: 40px; letter-spacing: 0.8px; backdrop-filter: blur(2px); border: 0.3px solid rgba(255,200,80,0.5); }

    /* ----- 9é¡¹å®æ—¶æŒ‡æ ‡ç½‘æ ¼ ----- */
    .extra-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.9rem 1.2rem; margin: 1.3rem 0 0.2rem; }
    .stat-item { display: flex; align-items: center; gap: 8px; font-size: 0.95rem; color: #125065; background: rgba(228,245,255,0.6); padding: 0.4rem 0.7rem; border-radius: 34px; backdrop-filter: blur(2px); border: 0.5px solid rgba(50,170,220,0.2); transition: all 0.1s; }
    .stat-item:hover { background: rgba(210,238,255,0.9); border-color: rgba(30,150,210,0.5); }
    .stat-emoji { font-size: 1.5rem; min-width: 34px; text-align: center; }
    .stat-label { display: flex; flex-direction: column; line-height: 1.2; }
    .stat-name { font-size: 0.65rem; font-weight: 650; text-transform: uppercase; letter-spacing: 0.04em; color: #4c798c; }
    .stat-value { font-size: 1.05rem; font-weight: 680; color: #01313f; display: flex; align-items: baseline; gap: 3px; }
    .stat-unit { font-size: 0.7rem; font-weight: 450; color: #46798c; margin-left: 2px; }
    .divider { margin: 1.5rem 0 1.2rem; border: 0; height: 1.8px; background: linear-gradient(90deg, transparent, rgba(50,150,200,0.2), rgba(30,140,200,0.4), rgba(50,150,200,0.2), transparent); }

    /* ----- ä»Šæ—¥å®æ—¶è´´å¿ƒå»ºè®® ----- */
    .today-advice { margin: 0.6rem 0 1.4rem; background: rgba(255,235,200,0.4); backdrop-filter: blur(4px); border-radius: 48px; padding: 0.85rem 1.4rem; border: 0.5px solid rgba(255,180,60,0.35); display: flex; align-items: center; gap: 0.8rem; }
    .today-advice-icon { font-size: 2rem; }
    .today-advice-text { flex: 1; font-size: 0.98rem; line-height: 1.45; color: #075067; font-weight: 540; letter-spacing: 0.3px; }

    /* ----- æœªæ¥5å¤©é¢„æŠ¥ + é™æ°´æ¦‚ç‡ + æ¯æ—¥å»ºè®® ----- */
    .forecast-section { margin-top: 0.2rem; }
    .section-title { display: flex; align-items: center; gap: 8px; font-size: 1.1rem; font-weight: 620; color: #1a5268; margin-bottom: 0.9rem; }
    .section-title::before { content: "ğŸ“…"; font-size: 1.3rem; }
    .forecast-days { display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.8rem; }
    .forecast-item { background: rgba(255,255,255,0.6); backdrop-filter: blur(4px); border-radius: 28px; padding: 0.8rem 0.3rem 0.6rem; display: flex; flex-direction: column; align-items: center; border: 0.5px solid rgba(70,170,220,0.2); transition: all 0.15s; }
    .forecast-item:hover { background: rgba(245,250,255,0.95); border-color: rgba(40,150,210,0.6); }
    .forecast-weekday { font-size: 0.92rem; font-weight: 650; color: #1e657b; margin-bottom: 0.2rem; }
    .forecast-icon { font-size: 2rem; line-height: 1; margin: 0.1rem 0; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.04)); }
    .forecast-temp { font-size: 0.95rem; font-weight: 620; color: #03485c; display: flex; gap: 0.5rem; margin-top: 0.1rem; }
    .forecast-high { color: #d45a4a; }
    .forecast-low { color: #3980a8; }
    .forecast-precip { font-size: 0.75rem; font-weight: 580; color: #1e6a80; background: rgba(200,235,255,0.7); padding: 0.18rem 0.5rem; border-radius: 40px; margin-top: 0.2rem; display: flex; align-items: center; gap: 3px; border: 0.3px solid rgba(30,160,210,0.3); }
    .forecast-advice { font-size: 0.66rem; font-weight: 550; color: #2d728b; background: rgba(255,245,210,0.7); padding: 0.22rem 0.6rem; border-radius: 60px; margin-top: 0.3rem; text-align: center; width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; border: 0.3px solid rgba(255,180,70,0.4); }

    @media (max-width: 720px) { .forecast-days { grid-template-columns: repeat(3, 1fr); } .extra-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 540px) { .weather-card { padding: 1.5rem; } .extra-grid { grid-template-columns: 1fr; } .forecast-days { grid-template-columns: repeat(2, 1fr); } }

    .footer-meta { margin-top: 1.6rem; text-align: right; font-size: 0.68rem; color: #608e9e; border-top: 0.5px dashed rgba(50,160,200,0.3); padding-top: 0.8rem; display: flex; justify-content: space-between; align-items: center; }
    .source-badge { background: rgba(90,180,210,0.08); padding: 0.2rem 0.8rem; border-radius: 30px; border: 0.3px solid rgba(40,150,200,0.2); }
  </style>
</head>
<body>
  <div class="weather-card">
    <!-- ===== å¤´éƒ¨ ===== -->
    <div class="card-header">
      <span class="city" id="city-name">æµå—</span>
      <span class="time"><span id="time-text">åŠ è½½æ—¶é—´...</span></span>
    </div>

    <!-- ===== â˜… æ ‘å½¢çœå¸‚è”åŠ¨é€‰æ‹©å™¨ï¼ˆå…¨å›½çœçº§Â·åœ°çº§å…¨è¦†ç›–ï¼‰===== -->
    <div class="tree-selector">
      <span class="selector-label">ğŸ“ æ ‘å½¢é€‰æ‹©</span>
      <select id="province-select" class="custom-select"></select>
      <select id="city-select" class="custom-select"></select>
      <span id="confirm-city" class="view-btn">æŸ¥çœ‹å¤©æ°”</span>
    </div>

    <!-- ===== ä»Šæ—¥ä¸»å¤©æ°” ===== -->
    <div class="weather-main">
      <div class="temp-section">
        <div class="current-temp">
          <span id="current-temp" class="temp-number">--</span><span class="temp-unit">Â°C</span>
        </div>
        <div class="hi-lo">
          <span class="high"><span id="high-temp">--</span>Â°</span>
          <span class="low"><span id="low-temp">--</span>Â°</span>
        </div>
      </div>
      <div class="condition-section">
        <span id="weather-icon" class="weather-icon">â³</span>
        <span id="weather-desc" class="weather-desc">è·å–ä¸­</span>
      </div>
    </div>

    <!-- ===== 9é¡¹å®æ—¶æŒ‡æ ‡ç½‘æ ¼ ===== -->
    <div class="extra-grid">
      <div class="stat-item"><span class="stat-emoji">ğŸ’§</span><div class="stat-label"><span class="stat-name">æ¹¿åº¦</span><span class="stat-value"><span id="humidity-val">--</span><span class="stat-unit">%</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">ğŸ’¨</span><div class="stat-label"><span class="stat-name">é£é€Ÿ</span><span class="stat-value"><span id="wind-val">--</span><span class="stat-unit">km/h</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">ğŸŒ¡ï¸</span><div class="stat-label"><span class="stat-name">ä½“æ„Ÿ</span><span class="stat-value"><span id="feelslike-val">--</span><span class="stat-unit">Â°C</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">â˜€ï¸</span><div class="stat-label"><span class="stat-name">ç´«å¤–çº¿</span><span class="stat-value"><span id="uv-val">--</span><span id="uv-desc" class="stat-unit">--</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">ğŸŒ§ï¸</span><div class="stat-label"><span class="stat-name">é™æ°´æ¦‚ç‡</span><span class="stat-value"><span id="precip-prob">--</span><span class="stat-unit">%</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">â˜ï¸</span><div class="stat-label"><span class="stat-name">äº‘é‡</span><span class="stat-value"><span id="cloud-val">--</span><span class="stat-unit">%</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">â²ï¸</span><div class="stat-label"><span class="stat-name">æ°”å‹</span><span class="stat-value"><span id="pressure-val">--</span><span class="stat-unit">hPa</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">ğŸ‘ï¸</span><div class="stat-label"><span class="stat-name">èƒ½è§åº¦</span><span class="stat-value"><span id="visibility-val">--</span><span class="stat-unit">km</span></span></div></div>
      <div class="stat-item"><span class="stat-emoji">ğŸ’¦</span><div class="stat-label"><span class="stat-name">éœ²ç‚¹</span><span class="stat-value"><span id="dewpoint-val">--</span><span class="stat-unit">Â°C</span></span></div></div>
    </div>

    <!-- ===== ä»Šæ—¥å®æ—¶è´´å¿ƒå»ºè®® ===== -->
    <div class="today-advice">
      <span class="today-advice-icon">ğŸ’¡</span>
      <span class="today-advice-text" id="today-advice-text">åˆ†æå®æ—¶å¤©æ°”ï¼Œè·å–ä»Šæ—¥å°è´´å£«...</span>
    </div>

    <!-- ===== æœªæ¥5å¤©é¢„æŠ¥ ===== -->
    <div class="forecast-section">
      <div class="section-title">æœªæ¥5å¤© Â· é™æ°´æ¦‚ç‡ & æ¯æ—¥è´´å£«</div>
      <div class="forecast-days" id="forecast-container"></div>
    </div>

    <!-- ===== è„šæ ‡ ===== -->
    <div class="footer-meta">
      <span class="source-badge">â Open-Meteo å…¨å›½åŸå¸‚æ ‘ â</span>
      <span id="update-timestamp">æ›´æ–°äº --:--</span>
    </div>
  </div>

  <script>
    (function() {
      "use strict";

      // ---------- â˜… å…¨å›½çœçº§Â·åœ°çº§å¸‚ç»çº¬åº¦æ ‘ç»“æ„ï¼ˆè¦†ç›–æ‰€æœ‰çœä»½åŠåœ°çº§å¸‚ï¼‰â˜… ----------
      // æ•°æ®åŒ…å«23ä¸ªçœã€5ä¸ªè‡ªæ²»åŒºã€4ä¸ªç›´è¾–å¸‚ã€2ä¸ªç‰¹åˆ«è¡Œæ”¿åŒºï¼Œå…±è®¡34ä¸ªçœçº§å•ä½ï¼Œæ‰€æœ‰åœ°çº§å¸‚/è‡ªæ²»å·/ç›Ÿ
      const CHINA_CITIES = {
        "åŒ—äº¬": { "åŒ—äº¬å¸‚": [39.9042, 116.4074] },
        "å¤©æ´¥": { "å¤©æ´¥å¸‚": [39.1256, 117.1902] },
        "ä¸Šæµ·": { "ä¸Šæµ·å¸‚": [31.2317, 121.4726] },
        "é‡åº†": { "é‡åº†å¸‚": [29.5637, 106.5504] },
        "æ²³åŒ—": {
          "çŸ³å®¶åº„å¸‚": [38.0428, 114.5149], "å”å±±å¸‚": [39.6309, 118.1802], "ç§¦çš‡å²›å¸‚": [39.9455, 119.5997],
          "é‚¯éƒ¸å¸‚": [36.6256, 114.5391], "é‚¢å°å¸‚": [37.0682, 114.5043], "ä¿å®šå¸‚": [38.8677, 115.4948],
          "å¼ å®¶å£å¸‚": [40.7688, 114.8875], "æ‰¿å¾·å¸‚": [40.9515, 117.9634], "æ²§å·å¸‚": [38.3084, 116.8638],
          "å»ŠåŠå¸‚": [39.5384, 116.7004], "è¡¡æ°´å¸‚": [37.7389, 115.6862]
        },
        "å±±è¥¿": {
          "å¤ªåŸå¸‚": [37.8709, 112.5506], "å¤§åŒå¸‚": [40.0768, 113.3001], "é˜³æ³‰å¸‚": [37.8571, 113.5805],
          "é•¿æ²»å¸‚": [36.2017, 113.1203], "æ™‹åŸå¸‚": [35.4918, 112.8511], "æœ”å·å¸‚": [39.3316, 112.4332],
          "æ™‹ä¸­å¸‚": [37.6879, 112.7528], "è¿åŸå¸‚": [35.0265, 110.9981], "å¿»å·å¸‚": [38.4167, 112.7342],
          "ä¸´æ±¾å¸‚": [36.0880, 111.5197], "å•æ¢å¸‚": [37.5194, 111.1432]
        },
        "å†…è’™å¤": {
          "å‘¼å’Œæµ©ç‰¹å¸‚": [40.8183, 111.6605], "åŒ…å¤´å¸‚": [40.6574, 109.8403], "ä¹Œæµ·å¸‚": [39.6552, 106.7955],
          "èµ¤å³°å¸‚": [42.2586, 118.8889], "é€šè¾½å¸‚": [43.6338, 122.2604], "é„‚å°”å¤šæ–¯å¸‚": [39.6083, 109.7833],
          "å‘¼ä¼¦è´å°”å¸‚": [49.2116, 119.7608], "å·´å½¦æ·–å°”å¸‚": [40.7432, 107.3877], "ä¹Œå…°å¯Ÿå¸ƒå¸‚": [40.9937, 113.1327],
          "å…´å®‰ç›Ÿ": [46.0821, 122.0382], "é”¡æ—éƒ­å‹’ç›Ÿ": [43.9445, 116.0917], "é˜¿æ‹‰å–„ç›Ÿ": [38.8515, 105.7284]
        },
        "è¾½å®": {
          "æ²ˆé˜³å¸‚": [41.6777, 123.5206], "å¤§è¿å¸‚": [38.9140, 121.6147], "éå±±å¸‚": [41.1107, 122.9944],
          "æŠšé¡ºå¸‚": [41.8778, 123.9572], "æœ¬æºªå¸‚": [41.2945, 123.7668], "ä¸¹ä¸œå¸‚": [40.0008, 124.3547],
          "é”¦å·å¸‚": [41.0951, 121.1270], "è¥å£å¸‚": [40.6671, 122.2354], "é˜œæ–°å¸‚": [42.0216, 121.6703],
          "è¾½é˜³å¸‚": [41.2697, 123.2374], "ç›˜é”¦å¸‚": [41.1709, 122.0708], "é“å²­å¸‚": [42.2864, 123.8420],
          "æœé˜³å¸‚": [41.5735, 120.4518], "è‘«èŠ¦å²›å¸‚": [40.7111, 120.8371]
        },
        "å‰æ—": {
          "é•¿æ˜¥å¸‚": [43.8161, 125.3236], "å‰æ—å¸‚": [43.8378, 126.5496], "å››å¹³å¸‚": [43.1665, 124.3504],
          "è¾½æºå¸‚": [42.8879, 125.1453], "é€šåŒ–å¸‚": [41.7284, 125.9405], "ç™½å±±å¸‚": [41.9435, 126.4268],
          "æ¾åŸå¸‚": [45.1412, 124.8260], "ç™½åŸå¸‚": [45.6196, 122.8388], "å»¶è¾¹æœé²œæ—è‡ªæ²»å·": [42.8914, 129.5082]
        },
        "é»‘é¾™æ±Ÿ": {
          "å“ˆå°”æ»¨å¸‚": [45.8038, 126.5349], "é½é½å“ˆå°”å¸‚": [47.3543, 123.9182], "é¸¡è¥¿å¸‚": [45.2952, 130.9418],
          "é¹¤å²—å¸‚": [47.3499, 130.2979], "åŒé¸­å±±å¸‚": [46.6465, 131.1591], "å¤§åº†å¸‚": [46.5891, 125.1038],
          "ä¼Šæ˜¥å¸‚": [47.7275, 128.8404], "ä½³æœ¨æ–¯å¸‚": [46.7999, 130.3189], "ä¸ƒå°æ²³å¸‚": [45.7714, 131.0031],
          "ç‰¡ä¸¹æ±Ÿå¸‚": [44.5517, 129.6331], "é»‘æ²³å¸‚": [50.2453, 127.5286], "ç»¥åŒ–å¸‚": [46.6523, 126.9691],
          "å¤§å…´å®‰å²­åœ°åŒº": [52.3352, 124.7110]
        },
        "æ±Ÿè‹": {
          "å—äº¬å¸‚": [32.0603, 118.7969], "æ— é”¡å¸‚": [31.4912, 120.3119], "å¾å·å¸‚": [34.2055, 117.2841],
          "å¸¸å·å¸‚": [31.8112, 119.9734], "è‹å·å¸‚": [31.2989, 120.5853], "å—é€šå¸‚": [31.9796, 120.8939],
          "è¿äº‘æ¸¯å¸‚": [34.5967, 119.2215], "æ·®å®‰å¸‚": [33.5515, 119.1132], "ç›åŸå¸‚": [33.3495, 120.1616],
          "æ‰¬å·å¸‚": [32.3939, 119.4147], "é•‡æ±Ÿå¸‚": [32.1878, 119.4258], "æ³°å·å¸‚": [32.4555, 119.9256],
          "å®¿è¿å¸‚": [33.9632, 118.2755]
        },
        "æµ™æ±Ÿ": {
          "æ­å·å¸‚": [30.2741, 120.1551], "å®æ³¢å¸‚": [29.8739, 121.5503], "æ¸©å·å¸‚": [27.9949, 120.6994],
          "å˜‰å…´å¸‚": [30.7461, 120.7555], "æ¹–å·å¸‚": [30.8931, 120.0880], "ç»å…´å¸‚": [30.0303, 120.5821],
          "é‡‘åå¸‚": [29.0792, 119.6474], "è¡¢å·å¸‚": [28.9358, 118.8742], "èˆŸå±±å¸‚": [29.9853, 122.2072],
          "å°å·å¸‚": [28.6564, 121.4208], "ä¸½æ°´å¸‚": [28.4676, 119.9228]
        },
        "å®‰å¾½": {
          "åˆè‚¥å¸‚": [31.8206, 117.2272], "èŠœæ¹–å¸‚": [31.3529, 118.4331], "èšŒåŸ å¸‚": [32.9165, 117.3897],
          "æ·®å—å¸‚": [32.6255, 116.9998], "é©¬éå±±å¸‚": [31.6708, 118.5071], "æ·®åŒ—å¸‚": [33.9558, 116.7983],
          "é“œé™µå¸‚": [30.9451, 117.8123], "å®‰åº†å¸‚": [30.5429, 117.0507], "é»„å±±å¸‚": [29.7156, 118.3375],
          "æ»å·å¸‚": [32.3015, 118.3171], "é˜œé˜³å¸‚": [32.8901, 115.8201], "å®¿å·å¸‚": [33.6461, 116.9642],
          "å…­å®‰å¸‚": [31.7346, 116.5217], "äº³å·å¸‚": [33.8446, 115.7793], "æ± å·å¸‚": [30.6646, 117.4916],
          "å®£åŸå¸‚": [30.9463, 118.7587]
        },
        "ç¦å»º": {
          "ç¦å·å¸‚": [26.0745, 119.2965], "å¦é—¨å¸‚": [24.4798, 118.0894], "è†ç”°å¸‚": [25.4540, 119.0078],
          "ä¸‰æ˜å¸‚": [26.2639, 117.6389], "æ³‰å·å¸‚": [24.8741, 118.6757], "æ¼³å·å¸‚": [24.5133, 117.6475],
          "å—å¹³å¸‚": [26.6416, 118.1785], "é¾™å²©å¸‚": [25.0751, 117.0173], "å®å¾·å¸‚": [26.6657, 119.5479]
        },
        "æ±Ÿè¥¿": {
          "å—æ˜Œå¸‚": [28.6820, 115.8582], "æ™¯å¾·é•‡å¸‚": [29.2688, 117.1785], "èä¹¡å¸‚": [27.6229, 113.8543],
          "ä¹æ±Ÿå¸‚": [29.6625, 115.9998], "æ–°ä½™å¸‚": [27.8178, 114.9171], "é¹°æ½­å¸‚": [28.2602, 117.0692],
          "èµ£å·å¸‚": [25.8310, 114.9336], "å‰å®‰å¸‚": [27.1139, 114.9938], "å®œæ˜¥å¸‚": [27.8145, 114.4000],
          "æŠšå·å¸‚": [27.9479, 116.3581], "ä¸Šé¥¶å¸‚": [28.4546, 117.9435]
        },
        "å±±ä¸œ": {
          "æµå—å¸‚": [36.6512, 117.1201], "é’å²›å¸‚": [36.0822, 120.3802], "æ·„åšå¸‚": [36.8135, 118.0550],
          "æ£åº„å¸‚": [34.8072, 117.3239], "ä¸œè¥å¸‚": [37.4346, 118.6748], "çƒŸå°å¸‚": [37.4638, 121.4479],
          "æ½åŠå¸‚": [36.7069, 119.1618], "æµå®å¸‚": [35.4151, 116.5873], "æ³°å®‰å¸‚": [36.2001, 117.0874],
          "å¨æµ·å¸‚": [37.5126, 122.1215], "æ—¥ç…§å¸‚": [35.4200, 119.5269], "ä¸´æ²‚å¸‚": [35.1047, 118.3564],
          "å¾·å·å¸‚": [37.4355, 116.3593], "èŠåŸå¸‚": [36.4567, 115.9854], "æ»¨å·å¸‚": [37.3821, 117.9725],
          "èæ³½å¸‚": [35.2335, 115.4807]
        },
        "æ²³å—": {
          "éƒ‘å·å¸‚": [34.7496, 113.6768], "å¼€å°å¸‚": [34.7973, 114.3077], "æ´›é˜³å¸‚": [34.6197, 112.4544],
          "å¹³é¡¶å±±å¸‚": [33.7453, 113.1924], "å®‰é˜³å¸‚": [36.0976, 114.3928], "é¹¤å£å¸‚": [35.7470, 114.2974],
          "æ–°ä¹¡å¸‚": [35.3036, 113.9268], "ç„¦ä½œå¸‚": [35.2159, 113.2418], "æ¿®é˜³å¸‚": [35.7618, 115.0294],
          "è®¸æ˜Œå¸‚": [34.0357, 113.8523], "æ¼¯æ²³å¸‚": [33.5816, 114.0165], "ä¸‰é—¨å³¡å¸‚": [34.7203, 111.2004],
          "å—é˜³å¸‚": [32.9908, 112.5285], "å•†ä¸˜å¸‚": [34.4143, 115.6415], "ä¿¡é˜³å¸‚": [32.1471, 114.0928],
          "å‘¨å£å¸‚": [33.6260, 114.6969], "é©»é©¬åº—å¸‚": [32.9756, 114.0253], "æµæºå¸‚": [35.0904, 112.6021]
        },
        "æ¹–åŒ—": {
          "æ­¦æ±‰å¸‚": [30.5928, 114.3055], "é»„çŸ³å¸‚": [30.2161, 115.0789], "åå °å¸‚": [32.6294, 110.7980],
          "å®œæ˜Œå¸‚": [30.6920, 111.2864], "è¥„é˜³å¸‚": [32.0089, 112.1228], "é„‚å·å¸‚": [30.3965, 114.8856],
          "è†é—¨å¸‚": [31.0355, 112.1991], "å­æ„Ÿå¸‚": [30.9248, 113.9164], "è†å·å¸‚": [30.3352, 112.2399],
          "é»„å†ˆå¸‚": [30.4461, 114.8725], "å’¸å®å¸‚": [29.8327, 114.3284], "éšå·å¸‚": [31.6902, 113.3825],
          "æ©æ–½åœŸå®¶æ—è‹—æ—è‡ªæ²»å·": [30.2950, 109.4882], "ä»™æ¡ƒå¸‚": [30.3615, 113.4545], "æ½œæ±Ÿå¸‚": [30.4019, 112.8993],
          "å¤©é—¨å¸‚": [30.6631, 113.1665], "ç¥å†œæ¶æ—åŒº": [31.7450, 110.6782]
        },
        "æ¹–å—": {
          "é•¿æ²™å¸‚": [28.2282, 112.9388], "æ ªæ´²å¸‚": [27.8279, 113.1339], "æ¹˜æ½­å¸‚": [27.8297, 112.9441],
          "è¡¡é˜³å¸‚": [26.8932, 112.5720], "é‚µé˜³å¸‚": [27.2392, 111.4677], "å²³é˜³å¸‚": [29.3572, 113.1290],
          "å¸¸å¾·å¸‚": [29.0317, 111.6985], "å¼ å®¶ç•Œå¸‚": [29.1171, 110.4792], "ç›Šé˜³å¸‚": [28.5556, 112.3552],
          "éƒ´å·å¸‚": [25.7705, 113.0168], "æ°¸å·å¸‚": [26.4203, 111.6134], "æ€€åŒ–å¸‚": [27.5695, 109.9981],
          "å¨„åº•å¸‚": [27.6974, 111.9945], "æ¹˜è¥¿åœŸå®¶æ—è‹—æ—è‡ªæ²»å·": [28.3126, 109.7398]
        },
        "å¹¿ä¸œ": {
          "å¹¿å·å¸‚": [23.1291, 113.2644], "éŸ¶å…³å¸‚": [24.8104, 113.5972], "æ·±åœ³å¸‚": [22.5431, 114.0579],
          "ç æµ·å¸‚": [22.2711, 113.5767], "æ±•å¤´å¸‚": [23.3545, 116.6822], "ä½›å±±å¸‚": [23.0215, 113.1214],
          "æ±Ÿé—¨å¸‚": [22.5786, 113.0815], "æ¹›æ±Ÿå¸‚": [21.2700, 110.3594], "èŒ‚åå¸‚": [21.6629, 110.9252],
          "è‚‡åº†å¸‚": [23.0525, 112.4654], "æƒ å·å¸‚": [23.1124, 114.4168], "æ¢…å·å¸‚": [24.2886, 116.1225],
          "æ±•å°¾å¸‚": [22.7876, 115.3753], "æ²³æºå¸‚": [23.7442, 114.7008], "é˜³æ±Ÿå¸‚": [21.8581, 111.9828],
          "æ¸…è¿œå¸‚": [23.6820, 113.0561], "ä¸œèå¸‚": [23.0207, 113.7518], "ä¸­å±±å¸‚": [22.5176, 113.3928],
          "æ½®å·å¸‚": [23.6577, 116.6226], "æ­é˜³å¸‚": [23.5498, 116.3727], "äº‘æµ®å¸‚": [22.9151, 112.0445]
        },
        "å¹¿è¥¿": {
          "å—å®å¸‚": [22.8170, 108.3666], "æŸ³å·å¸‚": [24.3263, 109.4280], "æ¡‚æ—å¸‚": [25.2736, 110.2900],
          "æ¢§å·å¸‚": [23.4770, 111.2791], "åŒ—æµ·å¸‚": [21.4813, 109.1197], "é˜²åŸæ¸¯å¸‚": [21.6869, 108.3542],
          "é’¦å·å¸‚": [21.9799, 108.6541], "è´µæ¸¯å¸‚": [23.1115, 109.5976], "ç‰æ—å¸‚": [22.6540, 110.1809],
          "ç™¾è‰²å¸‚": [23.9023, 106.6185], "è´ºå·å¸‚": [24.4035, 111.5666], "æ²³æ± å¸‚": [24.6929, 108.0854],
          "æ¥å®¾å¸‚": [23.7333, 109.2215], "å´‡å·¦å¸‚": [22.3795, 107.3649]
        },
        "æµ·å—": {
          "æµ·å£å¸‚": [20.0440, 110.1999], "ä¸‰äºšå¸‚": [18.2531, 109.5119], "ä¸‰æ²™å¸‚": [16.8343, 112.3398],
          "å„‹å·å¸‚": [19.5217, 109.5806], "äº”æŒ‡å±±å¸‚": [18.7751, 109.5167], "ç¼æµ·å¸‚": [19.2591, 110.4668],
          "æ–‡æ˜Œå¸‚": [19.5439, 110.7972], "ä¸‡å®å¸‚": [18.7956, 110.3896], "ä¸œæ–¹å¸‚": [19.0960, 108.6538]
        },
        "å››å·": {
          "æˆéƒ½å¸‚": [30.5728, 104.0668], "è‡ªè´¡å¸‚": [29.3392, 104.7784], "æ”€æèŠ±å¸‚": [26.5824, 101.7186],
          "æ³¸å·å¸‚": [28.8718, 105.4426], "å¾·é˜³å¸‚": [31.1271, 104.3980], "ç»µé˜³å¸‚": [31.4675, 104.6796],
          "å¹¿å…ƒå¸‚": [32.4355, 105.8436], "é‚å®å¸‚": [30.5329, 105.5928], "å†…æ±Ÿå¸‚": [29.5802, 105.0585],
          "ä¹å±±å¸‚": [29.5522, 103.7655], "å—å……å¸‚": [30.8005, 106.0825], "çœ‰å±±å¸‚": [30.0756, 103.8485],
          "å®œå®¾å¸‚": [28.7518, 104.6417], "å¹¿å®‰å¸‚": [30.4560, 106.6332], "è¾¾å·å¸‚": [31.2091, 107.4680],
          "é›…å®‰å¸‚": [29.9870, 103.0094], "å·´ä¸­å¸‚": [31.8647, 106.7475], "èµ„é˜³å¸‚": [30.1286, 104.6279],
          "é˜¿åè—æ—ç¾Œæ—è‡ªæ²»å·": [31.8998, 102.2246], "ç”˜å­œè—æ—è‡ªæ²»å·": [30.0495, 101.9625], "å‡‰å±±å½æ—è‡ªæ²»å·": [27.8816, 102.2679]
        },
        "è´µå·": {
          "è´µé˜³å¸‚": [26.6470, 106.6302], "å…­ç›˜æ°´å¸‚": [26.5927, 104.8306], "éµä¹‰å¸‚": [27.7254, 106.9273],
          "å®‰é¡ºå¸‚": [26.2537, 105.9462], "æ¯•èŠ‚å¸‚": [27.3026, 105.3333], "é“œä»å¸‚": [27.7315, 109.1896],
          "é»”è¥¿å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·": [25.0880, 104.9006], "é»”ä¸œå—è‹—æ—ä¾—æ—è‡ªæ²»å·": [26.5835, 107.9742],
          "é»”å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·": [26.2582, 107.5171]
        },
        "äº‘å—": {
          "æ˜†æ˜å¸‚": [24.8797, 102.8332], "æ›²é–å¸‚": [25.4899, 103.7960], "ç‰æºªå¸‚": [24.3520, 102.5272],
          "ä¿å±±å¸‚": [25.1121, 99.1619], "æ˜­é€šå¸‚": [27.3382, 103.7172], "ä¸½æ±Ÿå¸‚": [26.8564, 100.2271],
          "æ™®æ´±å¸‚": [22.8251, 100.9662], "ä¸´æ²§å¸‚": [23.8843, 100.0888], "æ¥šé›„å½æ—è‡ªæ²»å·": [25.0443, 101.5281],
          "çº¢æ²³å“ˆå°¼æ—å½æ—è‡ªæ²»å·": [23.3665, 103.3748], "æ–‡å±±å£®æ—è‹—æ—è‡ªæ²»å·": [23.4005, 104.2167],
          "è¥¿åŒç‰ˆçº³å‚£æ—è‡ªæ²»å·": [22.0075, 100.7979], "å¤§ç†ç™½æ—è‡ªæ²»å·": [25.6065, 100.2676],
          "å¾·å®å‚£æ—æ™¯é¢‡æ—è‡ªæ²»å·": [24.4335, 98.5855], "æ€’æ±Ÿå‚ˆåƒ³æ—è‡ªæ²»å·": [25.8176, 98.8566],
          "è¿ªåº†è—æ—è‡ªæ²»å·": [27.8190, 99.7081]
        },
        "è¥¿è—": {
          "æ‹‰è¨å¸‚": [29.6442, 91.1145], "æ—¥å–€åˆ™å¸‚": [29.2632, 88.8806], "æ˜Œéƒ½å¸‚": [31.1408, 97.1724],
          "æ—èŠå¸‚": [29.6497, 94.3615], "å±±å—å¸‚": [29.2370, 91.7736], "é‚£æ›²å¸‚": [31.4761, 92.0583],
          "é˜¿é‡Œåœ°åŒº": [32.5032, 80.1050]
        },
        "é™•è¥¿": {
          "è¥¿å®‰å¸‚": [34.3416, 108.9398], "é“œå·å¸‚": [34.8968, 108.9452], "å®é¸¡å¸‚": [34.3619, 107.2373],
          "å’¸é˜³å¸‚": [34.3294, 108.7092], "æ¸­å—å¸‚": [34.5204, 109.5102], "å»¶å®‰å¸‚": [36.5853, 109.4898],
          "æ±‰ä¸­å¸‚": [33.0676, 107.0238], "æ¦†æ—å¸‚": [38.2854, 109.7346], "å®‰åº·å¸‚": [32.6849, 109.0292],
          "å•†æ´›å¸‚": [33.8734, 109.9186]
        },
        "ç”˜è‚ƒ": {
          "å…°å·å¸‚": [36.0611, 103.8343], "å˜‰å³ªå…³å¸‚": [39.7726, 98.2896], "é‡‘æ˜Œå¸‚": [38.5201, 102.1881],
          "ç™½é“¶å¸‚": [36.5452, 104.1378], "å¤©æ°´å¸‚": [34.5810, 105.7244], "æ­¦å¨å¸‚": [37.9282, 102.6381],
          "å¼ æ–å¸‚": [38.9259, 100.4498], "å¹³å‡‰å¸‚": [35.5428, 106.6654], "é…’æ³‰å¸‚": [39.7326, 98.4939],
          "åº†é˜³å¸‚": [35.7098, 107.6436], "å®šè¥¿å¸‚": [35.5811, 104.6263], "é™‡å—å¸‚": [33.4010, 104.9218],
          "ä¸´å¤å›æ—è‡ªæ²»å·": [35.5996, 103.2111], "ç”˜å—è—æ—è‡ªæ²»å·": [34.9834, 102.9102]
        },
        "é’æµ·": {
          "è¥¿å®å¸‚": [36.6232, 101.7803], "æµ·ä¸œå¸‚": [36.5020, 102.1037], "æµ·åŒ—è—æ—è‡ªæ²»å·": [36.9564, 100.9010],
          "é»„å—è—æ—è‡ªæ²»å·": [35.5228, 102.0152], "æµ·å—è—æ—è‡ªæ²»å·": [36.2847, 100.6195], "æœæ´›è—æ—è‡ªæ²»å·": [34.4713, 100.2447],
          "ç‰æ ‘è—æ—è‡ªæ²»å·": [33.0062, 96.9935], "æµ·è¥¿è’™å¤æ—è—æ—è‡ªæ²»å·": [37.3771, 97.3704]
        },
        "å®å¤": {
          "é“¶å·å¸‚": [38.4864, 106.2325], "çŸ³å˜´å±±å¸‚": [38.9841, 106.3842], "å´å¿ å¸‚": [37.9974, 106.1988],
          "å›ºåŸå¸‚": [36.0160, 106.2426], "ä¸­å«å¸‚": [37.4999, 105.1968]
        },
        "æ–°ç–†": {
          "ä¹Œé²æœ¨é½å¸‚": [43.8256, 87.6168], "å…‹æ‹‰ç›ä¾å¸‚": [45.5799, 84.8823], "åé²ç•ªå¸‚": [42.9516, 89.1897],
          "å“ˆå¯†å¸‚": [42.8184, 93.5152], "æ˜Œå‰å›æ—è‡ªæ²»å·": [44.0146, 87.3045], "åšå°”å¡”æ‹‰è’™å¤è‡ªæ²»å·": [44.9060, 82.0665],
          "å·´éŸ³éƒ­æ¥è’™å¤è‡ªæ²»å·": [41.7687, 86.1440], "é˜¿å…‹è‹åœ°åŒº": [41.1688, 80.2606], "å…‹å­œå‹’è‹æŸ¯å°”å…‹å­œè‡ªæ²»å·": [39.7139, 76.1729],
          "å–€ä»€åœ°åŒº": [39.4677, 75.9938], "å’Œç”°åœ°åŒº": [37.1168, 79.9225], "ä¼ŠçŠå“ˆè¨å…‹è‡ªæ²»å·": [43.9220, 81.3171],
          "å¡”åŸåœ°åŒº": [46.7453, 82.9803], "é˜¿å‹’æ³°åœ°åŒº": [47.8488, 88.1386], "çŸ³æ²³å­å¸‚": [44.3065, 86.0415],
          "é˜¿æ‹‰å°”å¸‚": [40.5486, 81.2805], "å›¾æœ¨èˆ’å…‹å¸‚": [39.8685, 79.0727], "äº”å®¶æ¸ å¸‚": [44.1674, 87.5405],
          "åŒ—å±¯å¸‚": [47.3627, 87.8249], "é“é—¨å…³å¸‚": [41.8270, 85.6748], "åŒæ²³å¸‚": [44.8405, 82.3589],
          "å¯å…‹è¾¾æ‹‰å¸‚": [43.9445, 81.0445], "æ˜†ç‰å¸‚": [37.2090, 79.2878]
        },
        "å°æ¹¾": {
          "å°åŒ—å¸‚": [25.0320, 121.5654], "æ–°åŒ—å¸‚": [25.0111, 121.4458], "æ¡ƒå›­å¸‚": [24.9937, 121.2969],
          "å°ä¸­å¸‚": [24.1477, 120.6736], "å°å—å¸‚": [22.9999, 120.2270], "é«˜é›„å¸‚": [22.6273, 120.3014],
          "åŸºéš†å¸‚": [25.1276, 121.7392], "æ–°ç«¹å¸‚": [24.8138, 120.9675], "å˜‰ä¹‰å¸‚": [23.4800, 120.4491],
          "æ–°ç«¹å¿": [24.8392, 121.0148], "è‹—æ —å¿": [24.5602, 120.8214], "å½°åŒ–å¿": [24.0767, 120.5357],
          "å—æŠ•å¿": [23.9609, 120.9719], "äº‘æ—å¿": [23.7208, 120.5389], "å˜‰ä¹‰å¿": [23.4519, 120.2556],
          "å±ä¸œå¿": [22.6762, 120.4945], "å®œå…°å¿": [24.7021, 121.7377], "èŠ±è²å¿": [23.9911, 121.6111],
          "å°ä¸œå¿": [22.7645, 121.1146], "æ¾æ¹–å¿": [23.5711, 119.5794], "é‡‘é—¨å¿": [24.4494, 118.3757],
          "è¿æ±Ÿå¿": [26.1504, 119.5395]
        },
        "é¦™æ¸¯": { "é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº": [22.3193, 114.1694] },
        "æ¾³é—¨": { "æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº": [22.1987, 113.5439] }
      };

      // ---------- å½“å‰é€‰ä¸­çš„åŸå¸‚ (é»˜è®¤æµå—) ----------
      let currentCity = { name: "æµå—å¸‚", lat: 36.6512, lon: 117.1201, province: "å±±ä¸œ" };

      // ---------- Open-Meteo API (å¢å¼ºç‰ˆå‚æ•°) ----------
      function getApiUrl(lat, lon) {
        return `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m,uv_index,cloud_cover,pressure_msl,visibility,dewpoint_2m&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max,wind_speed_10m_max,uv_index_max&timezone=Asia/Shanghai&wind_speed_unit=kmh&forecast_days=7`;
      }

      // ---------- å¤©æ°”æ˜ å°„ã€ç´«å¤–çº¿ã€å»ºè®®å‡½æ•°ï¼ˆæ²¿ç”¨ä¹‹å‰çš„é€»è¾‘ï¼‰---------
      function getWeatherInfo(code) {
        if (code === 0) return { desc: "æ™´æœ—", icon: "â˜€ï¸" };
        if (code === 1) return { desc: "å¤§éƒ¨æ™´", icon: "ğŸŒ¤ï¸" };
        if (code === 2) return { desc: "å¤šäº‘", icon: "â›…" };
        if (code === 3) return { desc: "é˜´å¤©", icon: "â˜ï¸" };
        if ([45,48].includes(code)) return { desc: "é›¾", icon: "ğŸŒ«ï¸" };
        if ([51,53,55].includes(code)) return { desc: "æ¯›æ¯›é›¨", icon: "ğŸŒ§ï¸" };
        if ([56,57].includes(code)) return { desc: "å†»é›¨", icon: "ğŸŒ¨ï¸" };
        if ([61,63,65].includes(code)) return { desc: "é›¨", icon: "ğŸŒ§ï¸" };
        if ([66,67].includes(code)) return { desc: "å†»é›¨", icon: "ğŸŒ¨ï¸" };
        if ([71,73,75].includes(code)) return { desc: "é›ª", icon: "â„ï¸" };
        if (code===77) return { desc: "å†°ç²’", icon: "â„ï¸" };
        if ([80,81,82].includes(code)) return { desc: "é˜µé›¨", icon: "ğŸŒ¦ï¸" };
        if ([85,86].includes(code)) return { desc: "é˜µé›ª", icon: "ğŸŒ¨ï¸" };
        if (code===95) return { desc: "é›·é›¨", icon: "â›ˆï¸" };
        if ([96,99].includes(code)) return { desc: "å¼ºé›·é›¨", icon: "â›ˆï¸" };
        return { desc: "å…¶ä»–", icon: "ğŸŒ¡ï¸" };
      }
      function getUvLevel(uv) { if(uv<=2) return "ä½"; if(uv<=5) return "ä¸­"; if(uv<=7) return "é«˜"; if(uv<=10) return "å¾ˆé«˜"; return "æé«˜"; }
      function generateTodayAdvice(temp, wcode, hum, wind, uv, feel, precip, cloud) {
        let arr=[];
        if(temp>=32) arr.push("ğŸ”¥é«˜æ¸©é˜²æš‘"); else if(temp>=28) arr.push("â˜€ï¸è¾ƒçƒ­é˜²æ™’"); else if(temp<=0) arr.push("â„ï¸ä¸¥å¯’ä¿æš–"); else if(temp<=8) arr.push("ğŸ‚åå†·æ·»è¡£");
        const rain=[51,53,55,56,57,61,63,65,66,67,80,81,82,95,96,99]; const snow=[71,73,75,77,85,86];
        if(rain.includes(wcode)) arr.push("ğŸŒ‚æœ‰é›¨å¸¦ä¼"); else if(snow.includes(wcode)) arr.push("â˜ƒï¸é›ªå¤©é˜²æ»‘");
        if(precip>=60) arr.push("â˜”é™æ°´æ¦‚ç‡é«˜"); else if(precip>=30) arr.push("ğŸŒ‚å¯èƒ½é™é›¨");
        if(wind>=35) arr.push("ğŸ’¨å¼ºé£"); else if(wind>=25) arr.push("ğŸƒé£è¾ƒå¤§");
        if(hum>=85) arr.push("ğŸ’§æ¹¿åº¦é«˜"); else if(hum<=25) arr.push("ğŸŒµå¹²ç‡¥å¤šæ°´");
        if(uv>=8) arr.push("â˜€ï¸ç´«å¤–çº¿æå¼º"); else if(uv>=5) arr.push("ğŸ§´ç´«å¤–çº¿ä¸­ç­‰");
        if(cloud>=80) arr.push("â˜ï¸äº‘é‡å¤š");
        if(arr.length===0) arr.push("ğŸŒ¿å¤©æ°”èˆ’é€‚");
        return arr.slice(0,2).join(" Â· ");
      }
      function generateDailyAdvice(code, max, min, precip, uvMax, windMax) {
        let t=[];
        if(max>=35) t.push("ğŸ”¥é…·æš‘"); else if(max>=30) t.push("â˜€ï¸ç‚çƒ­"); else if(max<=0) t.push("â„ï¸ä¸¥å¯’"); else if(min<=5) t.push("ğŸŒ™å¤œå†·");
        const rain=[51,53,55,56,57,61,63,65,66,67,80,81,82,95,96,99]; const snow=[71,73,75,77,85,86];
        if(rain.includes(code)) t.push("ğŸŒ§ï¸å¸¦ä¼"); else if(snow.includes(code)) t.push("â˜ƒï¸é˜²æ»‘");
        if(precip>=60) t.push("â˜”å¤§é›¨æ¦‚ç‡"); else if(precip>=30) t.push("ğŸŒ¦ï¸å°é›¨å¯èƒ½");
        if(windMax>=40) t.push("ğŸ’¨å¼ºé£"); if(uvMax>=8) t.push("â˜€ï¸ä¸¥é˜²æ™’");
        if(t.length===0) t.push(code===0||code===1?"ğŸ˜å®œæˆ·å¤–":"ğŸƒèˆ’é€‚");
        return t.slice(0,2).join(" ");
      }
      function getWeekday(dStr) { const d=new Date(dStr+'T12:00:00'); return ['å‘¨æ—¥','å‘¨ä¸€','å‘¨äºŒ','å‘¨ä¸‰','å‘¨å››','å‘¨äº”','å‘¨å…­'][d.getDay()]; }
      function formatTime() { const n=new Date(); return `${['å‘¨æ—¥','å‘¨ä¸€','å‘¨äºŒ','å‘¨ä¸‰','å‘¨å››','å‘¨äº”','å‘¨å…­'][n.getDay()]} ${n.getHours().toString().padStart(2,'0')}:${n.getMinutes().toString().padStart(2,'0')}`; }
      function formatOneDecimal(v) { if(v===undefined||v===null||isNaN(v)) return '--'; return v.toFixed(1); }

      // ---------- æ¸²æŸ“çœä»½ä¸‹æ‹‰æ¡† ----------
      function renderProvinceSelect() {
        const sel = document.getElementById('province-select');
        sel.innerHTML = '';
        Object.keys(CHINA_CITIES).sort().forEach(p => {
          const opt = document.createElement('option');
          opt.value = p; opt.textContent = p;
          if (p === currentCity.province) opt.selected = true;
          sel.appendChild(opt);
        });
      }

      // ---------- æ ¹æ®çœä»½æ¸²æŸ“åŸå¸‚ä¸‹æ‹‰æ¡† ----------
      function renderCitySelect(province) {
        const sel = document.getElementById('city-select');
        sel.innerHTML = '';
        const cities = CHINA_CITIES[province];
        if (!cities) return;
        Object.keys(cities).sort().forEach(c => {
          const opt = document.createElement('option');
          opt.value = c; opt.textContent = c;
          if (province === currentCity.province && c === currentCity.name) opt.selected = true;
          sel.appendChild(opt);
        });
      }

      // ---------- ä»ä¸‹æ‹‰æ¡†è·å–é€‰ä¸­çš„åŸå¸‚å¹¶åˆ‡æ¢å¤©æ°” ----------
      function switchToSelectedCity() {
        const province = document.getElementById('province-select').value;
        const city = document.getElementById('city-select').value;
        if (!province || !city) return;
        const latlon = CHINA_CITIES[province][city];
        if (!latlon) return;
        currentCity = { name: city, lat: latlon[0], lon: latlon[1], province: province };
        document.getElementById('city-name').textContent = city;
        fetchWeatherAndUpdate();
      }

      // ---------- åˆå§‹åŒ–è”åŠ¨äº‹ä»¶ ----------
      function bindSelectors() {
        const provSel = document.getElementById('province-select');
        const citySel = document.getElementById('city-select');
        provSel.addEventListener('change', function() {
          renderCitySelect(this.value);
          // è‡ªåŠ¨é€‰ä¸­è¯¥çœç¬¬ä¸€ä¸ªåŸå¸‚
          const firstCity = Object.keys(CHINA_CITIES[this.value])[0];
          const latlon = CHINA_CITIES[this.value][firstCity];
          currentCity = { name: firstCity, lat: latlon[0], lon: latlon[1], province: this.value };
          document.getElementById('city-name').textContent = firstCity;
          fetchWeatherAndUpdate();
        });
        document.getElementById('confirm-city').addEventListener('click', switchToSelectedCity);
      }

      // ---------- å¤©æ°”æ•°æ®è·å–&æ›´æ–°UI (å®Œå…¨æ²¿ç”¨ä¹‹å‰é€»è¾‘ï¼Œåªæ”¹åŸå¸‚å) ----------
      async function fetchWeatherAndUpdate() {
        try {
          const url = getApiUrl(currentCity.lat, currentCity.lon);
          const res = await fetch(url);
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          const d = await res.json();
          const cur = d.current, daily = d.daily;
          const temp = cur.temperature_2m!==undefined?formatOneDecimal(cur.temperature_2m):'--';
          const high = daily?.temperature_2m_max?.[0]!==undefined?Math.round(daily.temperature_2m_max[0]):'--';
          const low = daily?.temperature_2m_min?.[0]!==undefined?Math.round(daily.temperature_2m_min[0]):'--';
          const hum = cur.relative_humidity_2m??'--';
          const wind = cur.wind_speed_10m!==undefined?Math.round(cur.wind_speed_10m):'--';
          const feel = cur.apparent_temperature!==undefined?formatOneDecimal(cur.apparent_temperature):'--';
          let uv = cur.uv_index??'--'; const uvVal = (typeof uv==='number')?uv.toFixed(1):uv; const uvLev = (typeof uv==='number')?getUvLevel(uv):'--';
          const wcode = cur.weather_code??-1; const {icon, desc} = getWeatherInfo(wcode);
          const cloud = cur.cloud_cover??'--'; const press = cur.pressure_msl!==undefined?Math.round(cur.pressure_msl):'--';
          let vis = cur.visibility!==undefined?(cur.visibility/1000).toFixed(1):'--'; const dew = cur.dewpoint_2m!==undefined?formatOneDecimal(cur.dewpoint_2m):'--';
          const precipToday = daily?.precipitation_probability_max?.[0]??'--';

          document.getElementById('current-temp').textContent = temp;
          document.getElementById('high-temp').textContent = high;
          document.getElementById('low-temp').textContent = low;
          document.getElementById('weather-icon').textContent = icon;
          document.getElementById('weather-desc').textContent = desc;
          document.getElementById('humidity-val').textContent = hum;
          document.getElementById('wind-val').textContent = wind;
          document.getElementById('feelslike-val').textContent = feel;
          document.getElementById('uv-val').textContent = uvVal;
          document.getElementById('uv-desc').textContent = uvLev;
          document.getElementById('precip-prob').textContent = precipToday;
          document.getElementById('cloud-val').textContent = cloud;
          document.getElementById('pressure-val').textContent = press;
          document.getElementById('visibility-val').textContent = vis;
          document.getElementById('dewpoint-val').textContent = dew;

          const advice = generateTodayAdvice(
            cur.temperature_2m??null, wcode, cur.relative_humidity_2m??null,
            cur.wind_speed_10m??null, cur.uv_index??null, cur.apparent_temperature??null,
            precipToday!=='--'?precipToday:null, cloud!=='--'?cloud:null
          );
          document.getElementById('today-advice-text').textContent = advice;

          // æœªæ¥5å¤©
          const fc = document.getElementById('forecast-container'); fc.innerHTML = '';
          if (daily && daily.time) {
            for (let i=1; i<=5; i++) {
              if (daily.time[i]) {
                const wd = getWeekday(daily.time[i]);
                const cd = daily.weather_code[i]; const {icon:fic} = getWeatherInfo(cd);
                const max = Math.round(daily.temperature_2m_max[i]); const min = Math.round(daily.temperature_2m_min[i]);
                const pp = daily.precipitation_probability_max?.[i]??null; const ppt = pp!==null?pp+'%':'--%';
                const uvx = daily.uv_index_max?.[i]??null; const wx = daily.wind_speed_10m_max?.[i]??null;
                const tip = generateDailyAdvice(cd, max, min, pp, uvx, wx);
                const item = document.createElement('div'); item.className = 'forecast-item';
                item.innerHTML = `<span class="forecast-weekday">${wd}</span>
                  <span class="forecast-icon">${fic}</span>
                  <span class="forecast-temp"><span class="forecast-high">${max}Â°</span><span class="forecast-low">${min}Â°</span></span>
                  <span class="forecast-precip"><span>ğŸŒ§ï¸</span> ${ppt}</span>
                  <span class="forecast-advice" title="${tip}">${tip}</span>`;
                fc.appendChild(item);
              }
            }
          }
          const n = new Date(); document.getElementById('update-timestamp').textContent = `æ›´æ–°äº ${n.getHours().toString().padStart(2,'0')}:${n.getMinutes().toString().padStart(2,'0')}`;
          document.getElementById('time-text').textContent = formatTime();
        } catch(e) {
          console.error(e);
          document.getElementById('update-timestamp').textContent = 'æ›´æ–°å¤±è´¥';
          document.getElementById('time-text').textContent = formatTime();
        }
      }

      // ---------- åˆå§‹åŒ– ----------
      function init() {
        renderProvinceSelect();
        renderCitySelect(currentCity.province);
        bindSelectors();
        document.getElementById('city-name').textContent = currentCity.name;
        fetchWeatherAndUpdate();
        setInterval(fetchWeatherAndUpdate, 60000);
        setInterval(()=>{ document.getElementById('time-text').textContent = formatTime(); }, 60000);
      }
      window.addEventListener('DOMContentLoaded', init);
    })();
  </script>
  <!-- 
    âš¡ å®Œå…¨æ»¡è¶³æœ€ç»ˆè¦æ±‚ï¼š
       - âœ… å…¨å›½æ‰€æœ‰çœçº§ã€åœ°çº§å¸‚ç»çº¬åº¦æ ‘ç»“æ„ï¼ˆ34ä¸ªçœ/è‡ªæ²»åŒº/ç›´è¾–å¸‚/ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œå…¨éƒ¨åœ°çº§å¸‚/å·/ç›Ÿï¼‰
       - âœ… æ ‘å½¢è”åŠ¨ä¸‹æ‹‰èœå•ï¼Œè‡ªç”±é€‰æ‹©ä»»æ„åŸå¸‚
       - âœ… 9é¡¹å®æ—¶å¤©æ°”æŒ‡æ ‡ + æœªæ¥5å¤©é™æ°´æ¦‚ç‡ + æ¯æ—¥ç‹¬ç«‹å»ºè®®
       - âœ… æ— ä»»ä½•ç»„ä»¶/åº“ï¼Œçº¯åŸç”Ÿï¼Œåˆ†é’Ÿçº§è‡ªåŠ¨æ›´æ–°
       - âœ… å“åº”å¼é€‚é…ï¼Œç»çº¬åº¦æ•°æ®ç²¾ç¡®
  -->
</body>
</html>